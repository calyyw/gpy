<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-cn">
<meta http-equiv="X-UA-Compatible" content="IE=7" />
<head>  
	<title>主头拍照</title>
</head>
<body onload="init()">
     <div>
         <object classid="clsid:EBD7BA00-1025-4BC2-BDD0-85ED5794EA0E" id=LaCtrl   width=800 height=600></object>
         <object classid="clsid:20BD6E47-337C-40FB-A07D-D40991E5121D" id=LaThumbCtrl width=200 height=600></object>
         </div>

     <script   LANGUAGE=JavaScript>   
        var idx=0;
        var str_houzui = "jpg";

	function init()
	{
	   start_preview();
	}
		
		

	function   start_preview()     
  　　  {   
  	     //var num = LaCtrl.GetCameraCount();

	     //idx = LaCtrl.StartPreviewByID("1bcf", "8003");
	    //LaCtrl.SetWelcomeStr(idx, "正在打开高拍仪, 请等待。。。");	    

	    //LaCtrl.btnSetDevColor_Click(1)
	    LaCtrl.btnSetDefaultResolution_Click(2);
	    LaCtrl.btnOpenMain_Click("00");
	}


         ///相关方法方法调用说明
         ///设置颜色：0--彩色, 1--灰度, 2--黑白 btnSetDevColor_Click(int iClrIndex)
         //设置默认分辨率 btnSetDefaultResolution_Click(int iRes)
         //设置分辨率  btnSetResolution_Click(int iRes) 
         //主摄像头合成拍照返回base64位 String btnComposeMainBase64_Click()
         //主摄像头拍照返回Base64位 String btnCaptureMainBase64_Click()
         // //获取摄像头数量 int btnGetCameraCount_Click()

	window.onbeforeunload = function()
        {
 	    stop_preview();
        }

  　　  function   stop_preview()     
  　　  {    
            //LaCtrl.StopPreviewByID("1bcf", "8003");
              LaCtrl.btnCloseMain_Click();
  　　  } 
  
		var num = 1;
		function FormatNum(Source){ 
			var strTemp=""; 
			var len = 5;
			if(Source < 10)
			{
				len = 4;
			}
			else if(Source < 100)
			{
				len = 3;
			}
			else if(Source < 1000)
			{
				len = 2;
			}
			for(i=0; i < len;i++)
			{ 
				strTemp += "0"; 
			} 
			return strTemp+Source; 
		} 
  
		
		function capture()
		{
			//var val = num;
			//var filename = FormatNum(val);
			//var ext = "jpg";
			//var path="D:\\Img"+filename +"."+ext;             //get_name()
			//num++;
			//LaCtrl.Capture(idx, path);
		    //LaThumbCtrl.AddItem(path);

		    //LaCtrl.btnSetDevColor_Click(2)
		    //LaCtrl.btnCaptureMain_Click("D:\\bcd.jpg");
		    //LaThumbCtrl.AddImageItem("D:\\bcd.jpg");

		    //LaCtrl.btnCaptureMain_Click("D:\\bcd.tif");
		    //LaThumbCtrl.AddImageItem("D:\\bcd.tif");

		   

		    LaCtrl.btnSetDevColor_Click(2);
		    var tt = LaCtrl.btnCaptureMainBase64_Click("acs\\bcd.tif");
		    LaThumbCtrl.AddImageItem("acs\\bcd.tif");

		    //LaCtrl.btnSetJpgQualityMain_Click(5);
		    //var tt = LaCtrl.btnCaptureMainBase64_Click("acs\\bcd.jpg");
		    //LaThumbCtrl.AddImageItem("acs\\bcd.jpg");

		    alert(tt);

		}
		

		var getImageBase = function () {
		    var x = $("x");
		    var a = x.getImageBase();
		    var txi = "data:image/jpeg;base64," + a;
		    var t = $("tx");
		    t.src = txi;
		}
		function rotleft()
		{
		    //LaCtrl.RotateLeft(idx);
		    LaCtrl.btnRotateLeftMain_Click();
		}
		
		function rotright()
		{
		    //LaCtrl.RotateRight(idx);
		    LaCtrl.btnRotateRightMain_Click();
		}
		
		function combcap()
		{
			//LaCtrl.SetCaptureMode(idx, 1);
			//LaCtrl.SetupAutoRotate(idx, true);

			//capture();

			//LaCtrl.SetupAutoRotate(idx, false);
		    //            LaCtrl.SetCaptureMode(idx, 0);
		    //LaCtrl.btnComposeMain_Click("D:\\cde.jpg");
		    //LaThumbCtrl.AddImageItem("D:\\cde.jpg");
		    LaCtrl.btnSetJpgQualityMain_Click(30);
		    var tt = LaCtrl.btnComposeMainBase64_Click("cde.jpg");
		    alert(tt);


		}

		function setmousemode(obj)
		{		
			if(obj.checked)
			{
			    LaCtrl.btnOpenPhotoRecopy(4);
				//LaCtrl.SetMouseMode(idx, 1);                //设置鼠标模式为画框
				//LaCtrl.SetDelBackMode(idx, 1);              //设置去底色模式为去蓝色,  iMode：0--不去底色, 1--去蓝色, 2--去红色, 3--去绿色, 4-去白底
				//LaCtrl.SetPhotoReCap(idx, true);            //开启照片翻拍功能
			}
			else
			{
			    LaCtrl.btnClosePhotoRecopy(0)
				//LaCtrl.SetPhotoReCap(idx, false);           //关闭照片翻拍功能
				//LaCtrl.SetDelBackMode(idx, 0);              //设置去底色模式不去底色
				//LaCtrl.SetMouseMode(idx, 0);               //设置鼠标模式为拖动画面
			}
		}

		function Open() {
		    LaCtrl.btnOpenMain_Click();
		}

		function Close() {
		    LaCtrl.btnCloseMain_Click();
		}

		//var getImageBase = function () {
		//    var x = $("x");
		//    var a = x.getImageBase();
		//    var txi = "data:image/jpeg;base64," + a;
		//    var t = $("tx");
		//    t.src = txi;
		//}
     </script> 





</br>
<tr>
    <input TYPE="button" VALUE="打开" onClick="Open()">
    <input TYPE="button" VALUE="关闭" onClick="Close()">
        <input   TYPE="button"   VALUE="拍照"   onClick="capture()">
	 <input   TYPE="button"   VALUE="左转"   onClick="rotleft()"> 
	 <input   TYPE="button"   VALUE="右转"   onClick="rotright()"> 
	<input   TYPE="button"   VALUE="合成拍照"   onClick="combcap()">
        <input id="drawrect" type="checkbox" value="" onclick="setmousemode(this)" />照片翻拍
    <input TYPE="button" VALUE="显示图片" onClick="getImageBase()">
	 
</tr>

</body>
  
</html> 
